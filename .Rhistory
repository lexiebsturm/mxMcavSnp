geom_segment(data = subset(snpPCoA, subset = pop %in% c("Banco de San Antonio", "Isla de la Juventud")), aes(xend = mean.x, yend = mean.y, color = pop)) +
scale_linetype_manual(values=c(1,2), breaks=c("Shallow","Mesophotic"), name = NULL)+
geom_point(aes(x = PCo1, y = PCo2, shape = depth), size = 3, alpha = 0.3) + #individual's points indicated by circles
scale_shape_manual(values = c(24,25), breaks=c("Shallow","Mesophotic"), name = "Depth Zone") +
geom_point(aes(x = mean.x, y = mean.y, shape = depth, fill = pop), size = 5, color = "black") + #population centroids indicated by triangles
scale_fill_manual(values = colPal2, name= "Cuba", breaks = levels(snpPCoA$pop)[1:8]) +
scale_color_manual(values = fkCubaPal, name = "Florida Keys", breaks = levels(snpPCoA$pop)[-(1:8)]) +
xlab(paste ("PCo 1 (", fkCubaSnpPcoaVar[1],"%)", sep = "")) + #Prints percent variation explained by first axis
ylab(paste ("PCo 2 (", fkCubaSnpPcoaVar[2],"%)", sep = "")) + #Prints percent variation explained by second axis
guides(shape = guide_legend(override.aes = list(size = 4), order=3),
linetype=guide_legend(override.aes=list(fill=NA)),
fill = guide_legend(override.aes = list(shape = 22, alpha = 1, color = NA, size = 4), order=2),
color = guide_legend(override.aes = list(shape = 22, alpha = 1, fill=fkCubaPal[9:12], color = NA, size = 4, linetype = 0), order=1))+
#facet_wrap(~region)+
theme_bw()
#levels(snpPCoA$pop)[1:8]
#levels(snpPCoA$pop)[-(1:8)]
fkCubaSnpPcoaPlot = fkCubaSnpPcoaPlotA +
theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "left",
panel.border = element_rect(color = "black", size = 1.2),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.key = element_blank())
######################################################################
fkCubasnpMa = as.matrix(read.table("fkCubaMcavNoClones.ibsMat"))
fkCubaMds = cmdscale(fkCubasnpMa, eig = TRUE, x.ret = TRUE)
summary(fkCubaMds)
# Determine percent variation captured on each axis
# Calculate the eigenvalues so later we can figure out % variation shown on each Principal Coordinate
fkCubaSnpPcoaVar = round(fkCubaMds$eig/sum(fkCubaMds$eig)*100, 1)
fkCubaSnpPcoaVar
# Format data to plot
fkCubaSnpPcoaValues = fkCubaMds$points
fkCubaSnpPcoaValues
snpI2P = read.csv("inds2popsNoClones.csv") # 2-column tab-delimited table of individual assignments to populations; must be in the same order as samples in the bam list or vcf file.
head(snpI2P)
row.names(snpI2P) = snpI2P[,1]
fkCubaSnpPcoaValues = cbind(snpI2P, fkCubaSnpPcoaValues[,c(1,2)])
head(fkCubaSnpPcoaValues)
View(fkCubaSnpPcoaValues)
View(fkCubaSnpPcoaValues)
View(snpI2P)
View(snpI2P)
######################################################################
fkCubasnpMa = as.matrix(read.table("fkCubaMcavNoClones.ibsMat"))
fkCubaMds = cmdscale(fkCubasnpMa, eig = TRUE, x.ret = TRUE)
summary(fkCubaMds)
# Determine percent variation captured on each axis
# Calculate the eigenvalues so later we can figure out % variation shown on each Principal Coordinate
fkCubaSnpPcoaVar = round(fkCubaMds$eig/sum(fkCubaMds$eig)*100, 1)
fkCubaSnpPcoaVar
# Format data to plot
fkCubaSnpPcoaValues = fkCubaMds$points
fkCubaSnpPcoaValues
snpI2P = read.csv("inds2popsNoClones.csv") # 2-column tab-delimited table of individual assignments to populations; must be in the same order as samples in the bam list or vcf file.
row.names(snpI2P) = snpI2P[,1]
fkCubaSnpPcoaValues = cbind(snpI2P, fkCubaSnpPcoaValues[,c(1,2)])
fkCubaSnpPcoaValues =as.data.frame(fkCubaSnpPcoaValues, sample = rownames(fkCubaSnpPcoaValues))
colnames(fkCubaSnpPcoaValues)[5] <- "PCo1"
colnames(fkCubaSnpPcoaValues)[6] <- "PCo2"
fkCubaSnpPcoaValues
snpPCoA = merge(fkCubaSnpPcoaValues, aggregate(cbind(mean.x=PCo1,mean.y=PCo2)~popsite, fkCubaSnpPcoaValues, mean), by="popsite")
snpPCoA$depth = factor(snpPCoA$depth, levels = levels(snpPCoA$depth)[c(2,1)])
snpPCoA$pop=as.factor(snpPCoA$pop)
snpPCoA$pop = factor(snpPCoA$pop, levels = levels(snpPCoA$pop)[c(1, 7, 8, 3, 6, 2, 5, 4, 11, 10, 9, 12)])
# SNP PCoA biplot
fkCubaPops = c("Banco de San Antonio",  "Guanahacabibes",        "Isla de la Juventud",   "Cayo Anclitas",
"Chivirico",             "Cabo Lucrecia",         "Cayo Sabinal",          "Cayo Jutias",
"Southern Dry Tortugas", "Northern Dry Tortugas", "Lower Keys",            "Upper Keys"  )
fkCubaPops=as.factor(fkCubaPops)
snpPCoA = snpPCoA %>% mutate(region =
case_when(pop == "Banco de San Antonio"| pop == "Cabo Lucrecia" | pop == "Cayo Anclitas" | pop == "Cayo Jutias" | pop == "Cayo Sabinal" | pop == "Chivirico"| pop == "Guanahacabibes" | pop == "Isla de la Juventud" ~ "Cuba",
pop == "Southern Dry Tortugas" | pop== "Northern Dry Tortugas" | pop=="Lower Keys" | pop=="Upper Keys" ~ "Florida Keys"))
fkCubaPal = c(paletteer_d("vapoRwave::vapoRwave", 8), paletteer_d("vapoRwave::jazzCup", direction = -1, 4))
colPal2=c("#20DE8BFF", "#FF6AD5FF", "#FFA88BFF", "#C774E7FF", "#C874AAFF", "#FF6A8BFF", "#CCDE8BFF", "#FFDE8BFF", "#7A3A9AFF", "#3F86BCFF", "#28ADA8FF", "#83DDE0FF")
fkCubaSnpPcoaPlotA = ggplot(snpPCoA, aes(x = PCo1, y = PCo2, color = pop, fill = pop, shape = depth, linetype = depth)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
stat_ellipse(data = subset(snpPCoA, subset = !pop %in% c("Banco de San Antonio", "Isla de la Juventud")), type = "t", geom = "polygon", alpha = 0.1) + #ellipse
geom_segment(data = subset(snpPCoA, subset = pop %in% c("Banco de San Antonio", "Isla de la Juventud")), aes(xend = mean.x, yend = mean.y, color = pop)) +
scale_linetype_manual(values=c(1,2), breaks=c("Shallow","Mesophotic"), name = NULL)+
geom_point(aes(x = PCo1, y = PCo2, shape = depth), size = 3, alpha = 0.3) + #individual's points indicated by circles
scale_shape_manual(values = c(24,25), breaks=c("Shallow","Mesophotic"), name = "Depth Zone") +
geom_point(aes(x = mean.x, y = mean.y, shape = depth, fill = pop), size = 5, color = "black") + #population centroids indicated by triangles
scale_fill_manual(values = colPal2, name= "Cuba", breaks = levels(snpPCoA$pop)[1:8]) +
scale_color_manual(values = fkCubaPal, name = "Florida Keys", breaks = levels(snpPCoA$pop)[-(1:8)]) +
xlab(paste ("PCo 1 (", fkCubaSnpPcoaVar[1],"%)", sep = "")) + #Prints percent variation explained by first axis
ylab(paste ("PCo 2 (", fkCubaSnpPcoaVar[2],"%)", sep = "")) + #Prints percent variation explained by second axis
guides(shape = guide_legend(override.aes = list(size = 4), order=3),
linetype=guide_legend(override.aes=list(fill=NA)),
fill = guide_legend(override.aes = list(shape = 22, alpha = 1, color = NA, size = 4), order=2),
color = guide_legend(override.aes = list(shape = 22, alpha = 1, fill=fkCubaPal[9:12], color = NA, size = 4, linetype = 0), order=1))+
#facet_wrap(~region)+
theme_bw()
#levels(snpPCoA$pop)[1:8]
#levels(snpPCoA$pop)[-(1:8)]
fkCubaSnpPcoaPlot = fkCubaSnpPcoaPlotA +
theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "left",
panel.border = element_rect(color = "black", size = 1.2),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.key = element_blank())
fkCubaSnpPcoaPlot
ggsave("fkCubaSnpPcoaPlot.tiff", plot = fkCubaSnpPcoaPlot, height = 7, width = 10, units = "in", dpi = 300)
if (!require("pacman")) install.packages("pacman")
pacman::p_load("adegenet", "dendextend", "flextable", "gdata", "ggdendro", "hierfstat", "Imap", "kableExtra",
"paletteer", "patchwork", "officer", "poppr", "RColorBrewer", "reshape2", "StAMPP",
"tidyverse", "vcfR", "vegan", "WGCNA", "ggnewscale", "rnaturalearth", "sf", "ggspatial", "cowplot", "marmap")
pacman::p_load_gh("eliocamp/ggnewscale", "ropensci/rnaturalearthhires")
fkCubaSites = read.csv("fkCubaSampleSites.csv", header = TRUE)
fkCubaSites$depth = factor(fkCubaSites$depth, levels = levels(fkCubaSites$depth)[c(2,1)])
fkCubaSites$reef = factor(fkCubaSites$reef, levels = levels(fkCubaSites$reef)[c(1, 7, 8, 3, 6, 2, 5, 4, 11, 10, 9, 12)])
fkCubaReefs = fkCubaSites %>% group_by(reef) %>% summarize(lat = mean(lat), lon = mean(lon))
fkCubaReefs$depthShape=c("Mesophotic", "Shallow", "Shallow", "Shallow", "Shallow", "Shallow", "Shallow", "Shallow", "Paired", "Paired", "Paired", "Paired")
fkCubaReefs$depthShape=as.factor(fkCubaReefs$depthShape)
fkCubaReefs$depthShape = factor(fkCubaReefs$depthShape, levels = levels(fkCubaReefs$depthShape)[c(2,3,1)])
fknmsBounds = read.csv("fknmsSPA.csv", header = TRUE)
usCuba = st_as_sf(ne_states(country = c("United States of America", "Cuba", "Mexico", "The Bahamas")))
florida = read_sf("fkShape/flKeys.shp") %>% st_transform(crs = 4326)
#bathy = read_sf("shp/flBathy.shp") %>% st_transform(crs = 4326) %>% subset(subset = DATASET %in% c("fl_shelf", "fl_coast"))
cubaMPA0=read_sf("WDPA_WDOECM_May2021_Public_CUB_shp/WDPA_WDOECM_May2021_Public_CUB_shp_0/WDPA_WDOECM_May2021_Public_CUB_shp-polygons.shp") %>% st_transform(crs = 4326)
cubaMPA0=filter(cubaMPA0, MARINE==1)
cubaMPA1=read_sf("WDPA_WDOECM_May2021_Public_CUB_shp/WDPA_WDOECM_May2021_Public_CUB_shp_1/WDPA_WDOECM_May2021_Public_CUB_shp-polygons.shp") %>% st_transform(crs = 4326)
cubaMPA1=filter(cubaMPA1, MARINE==1)
cubaMPA2=read_sf("WDPA_WDOECM_May2021_Public_CUB_shp/WDPA_WDOECM_May2021_Public_CUB_shp_2/WDPA_WDOECM_May2021_Public_CUB_shp-polygons.shp") %>% st_transform(crs = 4326)
cubaMPA2=filter(cubaMPA2, MARINE==1)
fknmsBounds=filter(fknmsBounds, type=="Sanctuary")
fkCubaPal = c(paletteer_d("vapoRwave::vapoRwave", 8), paletteer_d("vapoRwave::jazzCup", direction = -1, 4))
fkCubaMapA = ggplot() +
geom_polypath(data = fknmsBounds, aes(x = long, y = lat, group = location, color = type), alpha = 0.1, fill = "black") +
#geom_polypath(data = fknmsBounds[fknmsBounds$type == "Sanctuary",], aes(x = long, y = lat, group = location), alpha = 0.1, fill = "black", color = "blue") +
#geom_polypath(data = fknmsBounds[fknmsBounds$location == "FKNMS2",], aes(x = long, y = lat), fill = "aliceblue", color = NA) +
#geom_polypath(data = fknmsBounds, aes(x = long, y = lat, color = type, group = location), fill = NA) +
scale_fill_manual(values = fkCubaPal, name = "Site") +
scale_color_manual(values = c("blue"), labels = c("MPA Boundaries")) + #name = "Boundaries",
#labs(color="")+
geom_sf(data=cubaMPA0, color="blue")+
geom_sf(data=cubaMPA1, color="blue")+
geom_sf(data=cubaMPA2, color="blue")+
geom_sf(data = usCuba, fill = "white", size = 0.25) +
#coord_sf(xlim = c(-87, -74), ylim = c(19.5, 31.3)) +
coord_sf(xlim = c(-87, -74), ylim = c(19.5, 26)) +
geom_point(data = fkCubaReefs, aes(x = lon, y = lat, fill = reef, shape=depthShape), size = 3) +
scale_shape_manual(values= c(23, 24, 25), name="Depth Zone") +
scale_x_continuous(breaks = c(seq(-87, -74, by = 2))) +
#scale_y_continuous(breaks = c(seq(19, 32, by = 2))) +
scale_y_continuous(breaks = c(seq(19, 26, by = 2))) +
annotation_scale(location = "bl") +
annotation_north_arrow(location = "tr", which_north = "true", style = north_arrow_minimal()) +
# geom_rect(aes(xmin = -83.25, xmax = -82.95, ymin = 24.45, ymax = 24.75), color = "black", fill = NA, size = 0.4) +
# geom_rect(aes(xmin = -80.35, xmax = -80.15, ymin = 25.1, ymax = 25.3), color = "black", fill = NA, size = 0.4) +
# geom_rect(aes(xmin = -81.7, xmax = -81.5, ymin = 24.45, ymax = 24.65), color = "black", fill = NA, size = 0.4) +
# annotate(geom = "text", x = -83.22, y = 24.72, label = "A", size = 4) +
# annotate(geom = "text", x = -81.67, y = 24.62, label = "B", size = 4) +
# annotate(geom = "text", x = -80.32, y = 25.27, label = "C", size = 4) +
guides(fill = guide_legend(override.aes = list(shape = 21, size = 4), order = 1),
shape = guide_legend(order=2),
color = guide_legend(title=NULL, order = 3))+ #override.aes = list(fill=NA),
theme_bw() +
theme(plot.title = element_text(size = 9) ,
panel.background = element_rect(fill = "aliceblue"),
plot.background = element_blank(),
axis.title = element_blank(),
legend.position = "right")
fkCubaMapA
fkCubaMapA
fkCubaBathy=getNOAA.bathy(-87, -74,19.5, 26, resolution = 4)
a
fkCubaBathy=autoplot(fkCubaBathy, geom="contour", mapping=NULL, coast=TRUE)
fkCubaBathy=getNOAA.bathy(-87, -74,19.5, 26, resolution = 4)
fkCubaBathyMap=autoplot(fkCubaBathy, geom="contour", mapping=NULL, coast=TRUE)
fkCubaBathyMap
fkCubaBathyMap=autoplot(fkCubaBathy, geom="raster", mapping=NULL, coast=TRUE)
fkCubaBathyMap
fkCubaBathy=getNOAA.bathy(-87, -74,19.5, 31.3, resolution = 4)
fkCubaBathyMap=autoplot(fkCubaBathy, geom="raster", mapping=NULL, coast=TRUE)
fkCubaBathyMap
fkCubaBathyMap=autoplot(fkCubaBathy, geom="raster", deep=-150, shallow=-30, step=0, mapping=NULL, coast=TRUE)
fkCubaBathyMap=plot(fkCubaBathy, image=FALSE, bpal=NULL, land=FALSE,
deepest.isobath=-150, shallowest.isobath=-30, step, n=20,
lwd=1, lty=1, col="black", default.col="white", drawlabels = FALSE,
xlab="Longitude", ylab="Latitude", asp=1)
fkCubaBathyMap=plot(fkCubaBathy, image=FALSE, bpal=NULL, land=TRUE,
deepest.isobath=-150, shallowest.isobath=-30, step, n=20,
lwd=1, lty=1, col="black", default.col="white", drawlabels = FALSE,
xlab="Longitude", ylab="Latitude", asp=1)
plot(fkCubaBathy, image=FALSE, bpal=NULL, land=TRUE,
deepest.isobath=-150, shallowest.isobath=-30, step, n=20,
lwd=1, lty=1, col="black", default.col="white", drawlabels = FALSE,
xlab="Longitude", ylab="Latitude", asp=1)
fkCubaBathyMap=plot(fkCubaBathy, image=FALSE, bpal=NULL, land=TRUE,
deepest.isobath=-150, shallowest.isobath=-30, step, n=10,
lwd=1, lty=1, col="black", default.col="white", drawlabels = FALSE,
xlab="Longitude", ylab="Latitude", asp=1)
fkCubaBathyMap=plot(fkCubaBathy, image=FALSE, bpal=NULL, land=TRUE,
deep=-150, shallow=-30, step, n=10,
lwd=1, lty=1, col="black", default.col="white", drawlabels = FALSE,
xlab="Longitude", ylab="Latitude", asp=1)
fkCubaBathyMap=plot(fkCubaBathy, image=FALSE, bpal=NULL, land=TRUE,
deep=-150, shallow=-30, step, n=10,
lwd=1, lty=1, col="black", drawlabels = FALSE,
xlab="Longitude", ylab="Latitude", asp=1)
fkCubaBathyMap=plot(fkCubaBathy, #image=FALSE,
land=TRUE,
deep=-150, shallow=-30, step, n=10,
lwd=1, lty=1, col="black", drawlabels = FALSE,
xlab="Longitude", ylab="Latitude", asp=1)
fkCubaBathyMap=plot(fkCubaBathy, image=FALSE,
land=TRUE,
deep=-150, shallow=-30, step, n=10,
lwd=1, lty=1, col="black", drawlabels = FALSE,
xlab="Longitude", ylab="Latitude", asp=1)
fkCubaBathyMap=plot(fkCubaBathy, image=FALSE,
land=TRUE,
deep=-150, shallow=-30, step=10,
lwd=1, lty=1, col="black", drawlabels = FALSE,
xlab="Longitude", ylab="Latitude", asp=1)
if (!require("pacman")) install.packages("pacman")
pacman::p_load("adegenet", "dendextend", "flextable", "gdata", "ggdendro", "hierfstat", "Imap", "kableExtra",
"paletteer", "patchwork", "officer", "poppr", "RColorBrewer", "reshape2", "StAMPP",
"tidyverse", "vcfR", "vegan", "WGCNA", "ggnewscale", "rnaturalearth", "sf", "ggspatial", "cowplot", "marmap", "ggPlotBathy")
pacman::p_load_gh("eliocamp/ggnewscale", "ropensci/rnaturalearthhires")
setwd("/Users/student/Documents/GitHub/mxMcavSnp")
if (!require("pacman")) install.packages("pacman")
pacman::p_load("adegenet", "dendextend", "flextable", "gdata", "ggdendro", "hierfstat", "Imap", "kableExtra", "paletteer", "patchwork", "officer", "poppr", "RColorBrewer", "reshape2", "StAMPP", "tidyverse", "vcfR", "vegan", "WGCNA", "boa", "plyr", "rgdal", "broom", "rgeos", "ggmap", "moments", "car", "multcompView", "lsmeans", "pairwiseAdonis", "marmap", "ggsn", "edgeR","dplyr", "MCMC.OTU")
options(stringsAsFactors = FALSE)
devtools::install_github("dkahle/ggmap", force=TRUE)
mxSites = read.csv("mxSampleSites.csv", header=TRUE)
box <- make_bbox(Lon, Lat, data = mxSites)
#ggmap::register_google(key = "AIzaSyAgi2MUDvA69dA5nwt1wtaIURGwr6l_xzU", write=TRUE)
baseMap=get_map(location = box, zoom = 9, scale = 2, maptype = c("satellite"), source = c("google"), crop = TRUE, color = c("color"))
#baseMap=get_googlemap(location = box, zoom = 9, size = c(640, 640), scale = 2, maptype = c("satellite"), color = c("color"))
x.min = -89.85185
y.min = 22.35036
x.max = -88.65330
y.max = 23.35262
mxMap=ggmap(baseMap)+
geom_point(data = mxSites, size= 3, shape=21, aes(x = Lon, y = Lat, fill=Location)) +
scale_fill_manual(values = c("seagreen3", "blue"))+
#scale_shape_manual(values = c(24,25), name = "Depth Zone", breaks=c("Shallow", "Mesophotic")) + # define shape/color scales
scale_y_continuous(label=function(x){return(paste(x,"°N"))}, expand = c(0, 0))+
scale_x_continuous(label=function(x){return(paste(-x,"°W"))}, expand = c(0, 0))+
coord_equal()+
#ggsn::north(box, scale = 0.5, location= "topleft") +
#ggsn::scalebar(box, dist = 25, transform = TRUE, dist_unit="km",model = "WGS84",st.dist = 0.05, location="bottomright")+
ggsn::north(x.min = -89.85185, y.min = 22.35036, x.max = -88.65330, y.max = 23.35262, scale = 0.25, location= "bottomright", anchor = c(x =  x.max+0.125, y = y.min-0.1)) +
ggsn::scalebar(x.min = -89.85185, y.min = 22.35036, x.max = -88.65330, y.max = 23.35262, dist = 25, transform = TRUE,
dist_unit="km", model = "WGS84", st.dist = 0.05, location="bottomright", anchor = c(x =  x.max+0.2, y = y.min-0.175))+
theme_bw()+
theme(legend.position = "right",
axis.title.x = element_blank(),
axis.title.y = element_blank())
mxMap
box <- make_bbox(Lon, Lat, data = mxSites)
setwd("/Users/student/Documents/GitHub/mxMcavSnp")
setwd("/Users/student/Documents/GitHub/mxMcavSnp")
if (!require("pacman")) install.packages("pacman")
pacman::p_load("adegenet", "dendextend", "flextable", "gdata", "ggdendro", "hierfstat", "Imap", "kableExtra",
"paletteer", "patchwork", "officer", "poppr", "RColorBrewer", "reshape2", "StAMPP",
"tidyverse", "vcfR", "vegan", "WGCNA", "ggnewscale", "rnaturalearth", "sf", "ggspatial", "cowplot", "marmap")
pacman::p_load_gh("eliocamp/ggnewscale", "ropensci/rnaturalearthhires")
mxMapA = ggplot() +
geom_polypath(data = fknmsBounds, aes(x = long, y = lat, group = location, color = type), alpha = 0.1, fill = "black") +
#geom_polypath(data = fknmsBounds[fknmsBounds$type == "Sanctuary",], aes(x = long, y = lat, group = location), alpha = 0.1, fill = "black", color = "blue") +
#geom_polypath(data = fknmsBounds[fknmsBounds$location == "FKNMS2",], aes(x = long, y = lat), fill = "aliceblue", color = NA) +
#geom_polypath(data = fknmsBounds, aes(x = long, y = lat, color = type, group = location), fill = NA) +
scale_fill_manual(values = mxPal, name = "Site") +
scale_color_manual(values = c("blue"), labels = c("MPA Boundaries")) + #name = "Boundaries",
coord_sf(xlim = c(-87, -74), ylim = c(19.5, 26)) +
geom_point(data = mxReefs, aes(x = lon, y = lat, fill = reef, shape=depthShape), size = 3) +
scale_x_continuous(breaks = c(seq(-90, -87, by = 2))) +
#scale_y_continuous(breaks = c(seq(19, 32, by = 2))) +
scale_y_continuous(breaks = c(seq(22, 24, by = 2))) +
annotation_scale(location = "bl") +
annotation_north_arrow(location = "tr", which_north = "true", style = north_arrow_minimal()) +
# geom_rect(aes(xmin = -83.25, xmax = -82.95, ymin = 24.45, ymax = 24.75), color = "black", fill = NA, size = 0.4) +
# geom_rect(aes(xmin = -80.35, xmax = -80.15, ymin = 25.1, ymax = 25.3), color = "black", fill = NA, size = 0.4) +
# geom_rect(aes(xmin = -81.7, xmax = -81.5, ymin = 24.45, ymax = 24.65), color = "black", fill = NA, size = 0.4) +
# annotate(geom = "text", x = -83.22, y = 24.72, label = "A", size = 4) +
# annotate(geom = "text", x = -81.67, y = 24.62, label = "B", size = 4) +
# annotate(geom = "text", x = -80.32, y = 25.27, label = "C", size = 4) +
guides(fill = guide_legend(override.aes = list(shape = 21, size = 4), order = 1),
shape = guide_legend(order=2),
color = guide_legend(title=NULL, order = 3))+ #override.aes = list(fill=NA),
theme_bw() +
theme(plot.title = element_text(size = 9) ,
panel.background = element_rect(fill = "aliceblue"),
plot.background = element_blank(),
axis.title = element_blank(),
legend.position = "right")
mxPal=c("seagreen3", "blue")
mxMapA = ggplot() +
geom_polypath(data = fknmsBounds, aes(x = long, y = lat, group = location, color = type), alpha = 0.1, fill = "black") +
#geom_polypath(data = fknmsBounds[fknmsBounds$type == "Sanctuary",], aes(x = long, y = lat, group = location), alpha = 0.1, fill = "black", color = "blue") +
#geom_polypath(data = fknmsBounds[fknmsBounds$location == "FKNMS2",], aes(x = long, y = lat), fill = "aliceblue", color = NA) +
#geom_polypath(data = fknmsBounds, aes(x = long, y = lat, color = type, group = location), fill = NA) +
scale_fill_manual(values = mxPal, name = "Site") +
scale_color_manual(values = c("blue"), labels = c("MPA Boundaries")) + #name = "Boundaries",
coord_sf(xlim = c(-87, -74), ylim = c(19.5, 26)) +
geom_point(data = mxReefs, aes(x = lon, y = lat, fill = reef, shape=depthShape), size = 3) +
scale_x_continuous(breaks = c(seq(-90, -87, by = 2))) +
#scale_y_continuous(breaks = c(seq(19, 32, by = 2))) +
scale_y_continuous(breaks = c(seq(22, 24, by = 2))) +
annotation_scale(location = "bl") +
annotation_north_arrow(location = "tr", which_north = "true", style = north_arrow_minimal()) +
# geom_rect(aes(xmin = -83.25, xmax = -82.95, ymin = 24.45, ymax = 24.75), color = "black", fill = NA, size = 0.4) +
# geom_rect(aes(xmin = -80.35, xmax = -80.15, ymin = 25.1, ymax = 25.3), color = "black", fill = NA, size = 0.4) +
# geom_rect(aes(xmin = -81.7, xmax = -81.5, ymin = 24.45, ymax = 24.65), color = "black", fill = NA, size = 0.4) +
# annotate(geom = "text", x = -83.22, y = 24.72, label = "A", size = 4) +
# annotate(geom = "text", x = -81.67, y = 24.62, label = "B", size = 4) +
# annotate(geom = "text", x = -80.32, y = 25.27, label = "C", size = 4) +
guides(fill = guide_legend(override.aes = list(shape = 21, size = 4), order = 1),
shape = guide_legend(order=2),
color = guide_legend(title=NULL, order = 3))+ #override.aes = list(fill=NA),
theme_bw() +
theme(plot.title = element_text(size = 9) ,
panel.background = element_rect(fill = "aliceblue"),
plot.background = element_blank(),
axis.title = element_blank(),
legend.position = "right")
mxMapA
#mxSites$depth = factor(mxSites$depth, levels = levels(mxSites$depth)[c(2,1)])
#mxSites$reef = factor(mxSites$reef, levels = levels(mxSites$reef)[c(1, 7, 8, 3, 6, 2, 5, 4, 11, 10, 9, 12)])
mxReefs = mxSites %>% group_by(reef) %>% summarize(lat = mean(lat), lon = mean(lon))
mxSites = read.csv("mxSampleSites.csv", header = TRUE)
#mxSites$depth = factor(mxSites$depth, levels = levels(mxSites$depth)[c(2,1)])
#mxSites$reef = factor(mxSites$reef, levels = levels(mxSites$reef)[c(1, 7, 8, 3, 6, 2, 5, 4, 11, 10, 9, 12)])
mxReefs = mxSites %>% group_by(reef) %>% summarize(lat = mean(lat), lon = mean(lon))
#mxReefs$depthShape=c("Mesophotic", "Shallow", "Shallow", "Shallow", "Shallow", "Shallow", "Shallow", "Shallow", "Paired", "Paired", "Paired", "Paired")
#mxReefs$depthShape=as.factor(mxReefs$depthShape)
#mxReefs$depthShape = factor(mxReefs$depthShape, levels = levels(mxReefs$depthShape)[c(2,3,1)])
usCuba = st_as_sf(ne_states(country = c("United States of America", "Cuba", "Mexico", "The Bahamas")))
mxPal=c("seagreen3", "blue")
mxMapA = ggplot() +
geom_polypath(data = fknmsBounds, aes(x = long, y = lat, group = location, color = type), alpha = 0.1, fill = "black") +
#geom_polypath(data = fknmsBounds[fknmsBounds$type == "Sanctuary",], aes(x = long, y = lat, group = location), alpha = 0.1, fill = "black", color = "blue") +
#geom_polypath(data = fknmsBounds[fknmsBounds$location == "FKNMS2",], aes(x = long, y = lat), fill = "aliceblue", color = NA) +
#geom_polypath(data = fknmsBounds, aes(x = long, y = lat, color = type, group = location), fill = NA) +
scale_fill_manual(values = mxPal, name = "Site") +
scale_color_manual(values = c("blue"), labels = c("MPA Boundaries")) + #name = "Boundaries",
coord_sf(xlim = c(-87, -74), ylim = c(19.5, 26)) +
geom_point(data = mxReefs, aes(x = lon, y = lat, fill = reef, shape=depthShape), size = 3) +
scale_x_continuous(breaks = c(seq(-90, -87, by = 2))) +
#scale_y_continuous(breaks = c(seq(19, 32, by = 2))) +
scale_y_continuous(breaks = c(seq(22, 24, by = 2))) +
annotation_scale(location = "bl") +
annotation_north_arrow(location = "tr", which_north = "true", style = north_arrow_minimal()) +
# geom_rect(aes(xmin = -83.25, xmax = -82.95, ymin = 24.45, ymax = 24.75), color = "black", fill = NA, size = 0.4) +
# geom_rect(aes(xmin = -80.35, xmax = -80.15, ymin = 25.1, ymax = 25.3), color = "black", fill = NA, size = 0.4) +
# geom_rect(aes(xmin = -81.7, xmax = -81.5, ymin = 24.45, ymax = 24.65), color = "black", fill = NA, size = 0.4) +
# annotate(geom = "text", x = -83.22, y = 24.72, label = "A", size = 4) +
# annotate(geom = "text", x = -81.67, y = 24.62, label = "B", size = 4) +
# annotate(geom = "text", x = -80.32, y = 25.27, label = "C", size = 4) +
guides(fill = guide_legend(override.aes = list(shape = 21, size = 4), order = 1),
shape = guide_legend(order=2),
color = guide_legend(title=NULL, order = 3))+ #override.aes = list(fill=NA),
theme_bw() +
theme(plot.title = element_text(size = 9) ,
panel.background = element_rect(fill = "aliceblue"),
plot.background = element_blank(),
axis.title = element_blank(),
legend.position = "right")
mxMapA
mxMapA
mxMapA = ggplot() +
#geom_polypath(data = fknmsBounds, aes(x = long, y = lat, group = location, color = type), alpha = 0.1, fill = "black") +
#geom_polypath(data = fknmsBounds[fknmsBounds$type == "Sanctuary",], aes(x = long, y = lat, group = location), alpha = 0.1, fill = "black", color = "blue") +
#geom_polypath(data = fknmsBounds[fknmsBounds$location == "FKNMS2",], aes(x = long, y = lat), fill = "aliceblue", color = NA) +
#geom_polypath(data = fknmsBounds, aes(x = long, y = lat, color = type, group = location), fill = NA) +
geom_sf(data = usMx, fill = "white", size = 0.25) +
scale_fill_manual(values = mxPal, name = "Site") +
#scale_color_manual(values = c("blue"), labels = c("MPA Boundaries")) + #name = "Boundaries",
coord_sf(xlim = c(-87, -74), ylim = c(19.5, 26)) +
geom_point(data = mxReefs, aes(x = lon, y = lat, fill = reef, shape=depthShape), size = 3) +
scale_x_continuous(breaks = c(seq(-90, -87, by = 2))) +
#scale_y_continuous(breaks = c(seq(19, 32, by = 2))) +
scale_y_continuous(breaks = c(seq(22, 24, by = 2))) +
annotation_scale(location = "bl") +
annotation_north_arrow(location = "tr", which_north = "true", style = north_arrow_minimal()) +
# geom_rect(aes(xmin = -83.25, xmax = -82.95, ymin = 24.45, ymax = 24.75), color = "black", fill = NA, size = 0.4) +
# geom_rect(aes(xmin = -80.35, xmax = -80.15, ymin = 25.1, ymax = 25.3), color = "black", fill = NA, size = 0.4) +
# geom_rect(aes(xmin = -81.7, xmax = -81.5, ymin = 24.45, ymax = 24.65), color = "black", fill = NA, size = 0.4) +
# annotate(geom = "text", x = -83.22, y = 24.72, label = "A", size = 4) +
# annotate(geom = "text", x = -81.67, y = 24.62, label = "B", size = 4) +
# annotate(geom = "text", x = -80.32, y = 25.27, label = "C", size = 4) +
guides(fill = guide_legend(override.aes = list(shape = 21, size = 4), order = 1),
shape = guide_legend(order=2),
color = guide_legend(title=NULL, order = 3))+ #override.aes = list(fill=NA),
theme_bw() +
theme(plot.title = element_text(size = 9) ,
panel.background = element_rect(fill = "aliceblue"),
plot.background = element_blank(),
axis.title = element_blank(),
legend.position = "right")
#mxReefs$depthShape=c("Mesophotic", "Shallow", "Shallow", "Shallow", "Shallow", "Shallow", "Shallow", "Shallow", "Paired", "Paired", "Paired", "Paired")
#mxReefs$depthShape=as.factor(mxReefs$depthShape)
#mxReefs$depthShape = factor(mxReefs$depthShape, levels = levels(mxReefs$depthShape)[c(2,3,1)])
usMx = st_as_sf(ne_states(country = c("United States of America", "Cuba", "Mexico", "The Bahamas")))
mxPal=c("seagreen3", "blue")
mxMapA = ggplot() +
#geom_polypath(data = fknmsBounds, aes(x = long, y = lat, group = location, color = type), alpha = 0.1, fill = "black") +
#geom_polypath(data = fknmsBounds[fknmsBounds$type == "Sanctuary",], aes(x = long, y = lat, group = location), alpha = 0.1, fill = "black", color = "blue") +
#geom_polypath(data = fknmsBounds[fknmsBounds$location == "FKNMS2",], aes(x = long, y = lat), fill = "aliceblue", color = NA) +
#geom_polypath(data = fknmsBounds, aes(x = long, y = lat, color = type, group = location), fill = NA) +
geom_sf(data = usMx, fill = "white", size = 0.25) +
scale_fill_manual(values = mxPal, name = "Site") +
#scale_color_manual(values = c("blue"), labels = c("MPA Boundaries")) + #name = "Boundaries",
coord_sf(xlim = c(-87, -74), ylim = c(19.5, 26)) +
geom_point(data = mxReefs, aes(x = lon, y = lat, fill = reef, shape=depthShape), size = 3) +
scale_x_continuous(breaks = c(seq(-90, -87, by = 2))) +
#scale_y_continuous(breaks = c(seq(19, 32, by = 2))) +
scale_y_continuous(breaks = c(seq(22, 24, by = 2))) +
annotation_scale(location = "bl") +
annotation_north_arrow(location = "tr", which_north = "true", style = north_arrow_minimal()) +
# geom_rect(aes(xmin = -83.25, xmax = -82.95, ymin = 24.45, ymax = 24.75), color = "black", fill = NA, size = 0.4) +
# geom_rect(aes(xmin = -80.35, xmax = -80.15, ymin = 25.1, ymax = 25.3), color = "black", fill = NA, size = 0.4) +
# geom_rect(aes(xmin = -81.7, xmax = -81.5, ymin = 24.45, ymax = 24.65), color = "black", fill = NA, size = 0.4) +
# annotate(geom = "text", x = -83.22, y = 24.72, label = "A", size = 4) +
# annotate(geom = "text", x = -81.67, y = 24.62, label = "B", size = 4) +
# annotate(geom = "text", x = -80.32, y = 25.27, label = "C", size = 4) +
guides(fill = guide_legend(override.aes = list(shape = 21, size = 4), order = 1),
shape = guide_legend(order=2),
color = guide_legend(title=NULL, order = 3))+ #override.aes = list(fill=NA),
theme_bw() +
theme(plot.title = element_text(size = 9) ,
panel.background = element_rect(fill = "aliceblue"),
plot.background = element_blank(),
axis.title = element_blank(),
legend.position = "right")
mxMapA
mxMapA
mxMapA = ggplot() +
#geom_polypath(data = fknmsBounds, aes(x = long, y = lat, group = location, color = type), alpha = 0.1, fill = "black") +
#geom_polypath(data = fknmsBounds[fknmsBounds$type == "Sanctuary",], aes(x = long, y = lat, group = location), alpha = 0.1, fill = "black", color = "blue") +
#geom_polypath(data = fknmsBounds[fknmsBounds$location == "FKNMS2",], aes(x = long, y = lat), fill = "aliceblue", color = NA) +
#geom_polypath(data = fknmsBounds, aes(x = long, y = lat, color = type, group = location), fill = NA) +
geom_sf(data = usMx, fill = "white", size = 0.25) +
scale_fill_manual(values = mxPal, name = "Site") +
#scale_color_manual(values = c("blue"), labels = c("MPA Boundaries")) + #name = "Boundaries",
coord_sf(xlim = c(-87, -74), ylim = c(19.5, 26)) +
geom_point(data = mxReefs, aes(x = lon, y = lat, fill = reef), size = 3) +
scale_x_continuous(breaks = c(seq(-90, -87, by = 2))) +
#scale_y_continuous(breaks = c(seq(19, 32, by = 2))) +
scale_y_continuous(breaks = c(seq(22, 24, by = 2))) +
annotation_scale(location = "bl") +
annotation_north_arrow(location = "tr", which_north = "true", style = north_arrow_minimal()) +
# geom_rect(aes(xmin = -83.25, xmax = -82.95, ymin = 24.45, ymax = 24.75), color = "black", fill = NA, size = 0.4) +
# geom_rect(aes(xmin = -80.35, xmax = -80.15, ymin = 25.1, ymax = 25.3), color = "black", fill = NA, size = 0.4) +
# geom_rect(aes(xmin = -81.7, xmax = -81.5, ymin = 24.45, ymax = 24.65), color = "black", fill = NA, size = 0.4) +
# annotate(geom = "text", x = -83.22, y = 24.72, label = "A", size = 4) +
# annotate(geom = "text", x = -81.67, y = 24.62, label = "B", size = 4) +
# annotate(geom = "text", x = -80.32, y = 25.27, label = "C", size = 4) +
guides(fill = guide_legend(override.aes = list(shape = 21, size = 4), order = 1),
shape = guide_legend(order=2),
color = guide_legend(title=NULL, order = 3))+ #override.aes = list(fill=NA),
theme_bw() +
theme(plot.title = element_text(size = 9) ,
panel.background = element_rect(fill = "aliceblue"),
plot.background = element_blank(),
axis.title = element_blank(),
legend.position = "right")
mxMapA
mxMapA = ggplot() +
geom_sf(data = usMx, fill = "white", size = 0.25) +
geom_point(data = mxReefs, aes(x = lon, y = lat, fill = reef), size = 3) +
scale_fill_manual(values = mxPal, name = "Site") +
#scale_color_manual(values = c("blue"), labels = c("MPA Boundaries")) + #name = "Boundaries",
coord_sf(xlim = c(-90, -87), ylim = c(22, 24)) +
scale_x_continuous(breaks = c(seq(-90, -87, by = 2))) +
scale_y_continuous(breaks = c(seq(22, 24, by = 2))) +
annotation_scale(location = "bl") +
annotation_north_arrow(location = "tr", which_north = "true", style = north_arrow_minimal()) +
#guides(fill = guide_legend(override.aes = list(shape = 21, size = 4), order = 1),
#shape = guide_legend(order=2),
#color = guide_legend(title=NULL, order = 3))+ #override.aes = list(fill=NA),
theme_bw() +
theme(plot.title = element_text(size = 9) ,
panel.background = element_rect(fill = "aliceblue"),
plot.background = element_blank(),
axis.title = element_blank(),
legend.position = "right")
mxMapA
mxMapA
its2Seq = read.csv("mxIts2SeqCounts.csv", header = TRUE, check.names = FALSE)
head(its2Seq)
its2Seq = read.csv("mxIts2SeqCounts.csv", header = TRUE, check.names = FALSE)
head(its2Seq)
its2Seq$depthZoneM = factor(its2Seq$depthZoneM, levels = c("10", "15", "25", "35"))
levels(its2Seq$depthZoneM)
its2Seq$site = factor(its2Seq$site, levels(its2Seq$site)[c(1,2)])
its2Seq = its2Seq[order(its2Seq$site, its2Seq$depthZoneM), ]
head(its2Seq)
